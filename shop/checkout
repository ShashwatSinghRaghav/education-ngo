<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="Rijusiddha Drewett | Karuna Trust">
    <meta name="csrf-token" content="5MI5GyweWCbXl3aw6ejoWWgxDCs4rLdQTnd0oKvq">
    <meta name="google-site-verification" content="a8L_KMZPk1GZcCOXloCr0Ip5CuJZG9AP9pnal3NvYjY" />
    <meta property="fb:app_id" content="460831424122339"/>
    
        <title>The Karuna Shop</title>

    
    
    <meta property="og:title" content="The Karuna Shop" />
    <meta property="og:description" content="" />

            <meta property="og:url" content="/shop">
        <meta property="og:type" content="article">
    

    <link rel="shortcut icon" href="https://karuna.org/images/favicon.png" >

    <link rel="stylesheet" href="https://use.typekit.net/rkq2qdi.css">
    <link
        rel="stylesheet"
        href="https://karuna.org/vendor/just-read-the-instructions/gutenberg.css"
    />



    <script src="https://kit.fontawesome.com/5eb8531614.js" crossorigin="anonymous"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/limonte-sweetalert2/7.2.0/sweetalert2.all.min.js"></script>

        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.4.0/animate.min.css">

    <link href="https://karuna.org/css/app.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker.min.css"/>

        <link href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css" rel="stylesheet">
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'G-E5Z14NLKVG', 'auto');
        ga('send', 'pageview');

    </script>
    <script src="https://sky.blackbaudcdn.net/static/sky-addin-client/1/sky-addin-client.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/es6-promise@4/dist/es6-promise.auto.min.js"></script>
    <script src='https://www.google.com/recaptcha/api.js'></script>


</head>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-E5Z14NLKVG"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){window.dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-E5Z14NLKVG');
</script>

<body>
<div id="shop">
    <div id="top-nav" class="text-white text-uppercase px-3 d-flex flex-row-reverse">

    <div class="social d-flex align-items-center">
                    <a class="" target="_blank" href="https://www.facebook.com/karuna.org/"/> <i class="fab fa-facebook-f"></i> </a>
                    <a class="" target="_blank" href="https://twitter.com/karuna_trust_uk?lang=en"/> <i class="fab fa-twitter"></i> </a>
                    <a class="pr-3" target="_blank" href="https://www.instagram.com/karunatrust"/> <i class="fab fa-instagram"></i> </a>
                |<a class="pl-3 contact" href="/contact">CONTACT</a>
    </div>
</div>
    <div class="site-navigation w-100  text-uppercase pb-3 position-absolute alt-nav text-red">
    <div class="container-fluid d-flex align-items-center">

        <div class="main-nav d-flex align-items-center mr-auto">

            <nav class="navbar p-0 navbar-expand-lg">
                <a class="navbar-brand" href="https://www.karuna.org"><img src="https://karuna.org/images/downloaded-assets/Horizontal_Logo_1_red.svg" class="main-logo img-fluid"/></a>

                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarText" aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse ml-3" id="navbarText">
                    <ul class='navbar-nav mr-auto d-flex align-items-center justify-content-between'><li class='border-right border-red nav-item position-relative text-red'><a class="nav-link demi" href="/our-work" target="_self">Our Work</a></li><li class='border-right border-red nav-item position-relative text-red'><a class="nav-link demi" href="/about-us" target="_self">About Us</a></li><li class='border-right border-red nav-item position-relative text-red'><a class="nav-link demi" href="/projects" target="_self">Our Projects</a></li><li class='border-right border-red nav-item position-relative text-red'><a class="nav-link dropdown demi" href="/" target="_self">Get Involved</a><ul><li class='border-right border-red nav-item position-relative text-red'><a class="nav-link demi dropdown" href="/donate" target="_self">Join a campaign</a><ul><li class='border-right border-red nav-item position-relative text-red'><a class="nav-link demi" href="/coronavirus-crisis" target="_self">Coronavirus Crisis</a></li></ul></li><li class='border-right border-red nav-item position-relative text-red'><a class="nav-link demi" href="/fundraise" target="_self">Fundraise for us</a><ul><li class='border-right border-red nav-item position-relative text-red'><a class="nav-link demi" href="/legacies" target="_self">Leave a gift in your will</a></li></ul></li></ul></li></ul>
                </div>
            </nav>
        </div>
        <div class="second-nav d-flex align-items-center">

            <a class="cart pr-3 text-white position-relative border-right border-brand-r " href="https://www.karuna.org/shop/cart"><i class="fas text-red fa-shopping-cart"></i><span class="count">0</span></a>
            <nav class="navbar p-0 navbar-expand-lg">

                <ul class='d-flex align-items-center navbar-nav ml-auto'><li class='border-right border-red text-center position-relative nav-item text-red'><a class="nav-link demi" href="https://www.blog.karuna.org/" target="_self">Blog</a></li></ul>

                <a class="btn border-right-0 ml-1 py-1 px-5 px-md-4 slide-f demi" href="/fundraise">FUNDRAISE</a>
                <a class="py-1 px-5 px-md-4 btn pulse text-white demi" href="/donate">DONATE</a>
            </nav>

        </div>
    </div>
</div>
<div id="mobile-nav">
    <div class="wrapper">
        <div class="mobile-top d-flex align-items-center">
            <a class="" href="https://www.karuna.org"><img src="https://karuna.org/images/karuna-horizontal-logo.png" class="w-50 img-fluid"/></a>

            <i class="fas fa-bars navbar-toggle collapsed" data-toggle="slide-collapse" data-target="#sidebar-nav" aria-expanded="false"></i>
        </div>
    </div>
    <div class="mobile-buttons d-flex">
        <a class="btn btn-fundraise" href="/fundraise">FUNDRAISE</a>
        <a class=" btn btn-donate" href="/donate">DONATE</a>
    </div>
    <div class="" id="sidebar-nav">
        <a class="" href="https://www.karuna.org"><img src="https://karuna.org/images/downloaded-assets/Horizontal_Logo_1_.svg" class="img-fluid"/></a>
        <ul class='navbar-nav mr-auto'><li class='nav-item'><a class="nav-link demi" href="/our-work" target="_self">Our Work</a></li><li class='nav-item'><a class="nav-link demi" href="/about-us" target="_self">About Us</a></li><li class='nav-item'><a class="nav-link demi" href="/projects" target="_self">Our Projects</a></li><li class='nav-item'><a class="nav-link dropdown demi" href="/" target="_self">Get Involved</a><ul><li class='nav-item'><a class="nav-link demi dropdown" href="/donate" target="_self">Join a campaign</a><ul><li class='nav-item'><a class="nav-link demi" href="/coronavirus-crisis" target="_self">Coronavirus Crisis</a></li></ul></li><li class='nav-item'><a class="nav-link demi" href="/fundraise" target="_self">Fundraise for us</a><ul><li class='nav-item'><a class="nav-link demi" href="/legacies" target="_self">Leave a gift in your will</a></li></ul></li></ul></li></ul>
        <h4 class="text-white pl-2"><u>Useful Links</u></h4>
        <ul class='navbar-nav mr-auto'><li class='nav-item'><a class="nav-link " href="/fundraise" target="_self">Fundraise for Us</a></li><li class='nav-item'><a class="nav-link " href="/legacies" target="_self">Leave a Gift in Your Will</a></li><li class='nav-item'><a class="nav-link team" href="https://appeals.karuna.org/jobs" target="_self">Join the Team</a></li></ul>
        <ul class='navbar-nav mr-auto'><li class='nav-item'><a class="nav-link " href="/trustees" target="_self">Trustees</a></li><li class='nav-item'><a class="nav-link " href="/ambassadors" target="_self">Ambassadors</a></li><li class='nav-item'><a class="nav-link " href="/financials" target="_self">Financials</a></li></ul>
        <ul class='navbar-nav mr-auto'><li class='nav-item'><a class="nav-link " href="/faqs" target="_self">FAQs</a></li><li class='nav-item'><a class="nav-link " href="/privacy-policy" target="_self">Privacy Policy</a></li><li class='nav-item'><a class="nav-link " href="/safeguarding-policy" target="_self">Safeguarding Policy</a></li></ul>
    </div>
</div>

        
    <div class="info-banner text-center mb-5">
        <div class="bg-beige">
            <div class="container">
                <p class="text-uppercase text-center">Karuna Shop</p>
                <h1 class="text-red text-center">Products to Support Projects</h1>
            </div>
        </div>
    </div>

        <div id="content">
        <div class="container">
                <div class="alert d-none alert-success text-center">
                    <a href="#" class="close" data-dismiss="alert" aria-label="close">×</a>
                    <p class="mb-0"></p>
                </div>

                <input type="hidden" name="_token" value="5MI5GyweWCbXl3aw6ejoWWgxDCs4rLdQTnd0oKvq">            <table class="table table-bordered" id="checkoutTable">

                <tr>
                    <th class="bg-secondary text-white">Order Details</th>
                </tr>
                <tr>
                    <td>
                        <table id="cart" class="table table-hover table-condensed border-top-0">
                            <thead>
                                <tr class="align-middle font-xs text-uppercase text-center">
                                    <th class="text-left" colspan="2" style="width:60%">ITEM</th>
                                    <th style="width:8%">Qty.</th>
                                    <th style="width:10%">Price</th>
                                    <th style="width:22%" class="text-center">Subtotal</th>
                                </tr>
                            </thead>
                            <tbody>
                                                                    <tr>
                                        <td class="align-middle text-center font-xl" colspan="5">You have no products in your cart</td>
                                    </tr>
                                                            </tbody>
                            <tfoot>
                                <tr class="font-xl">
                                    <td colspan="4" class="hidden-xs"></td>
                                    <td class="hidden-xs text-center"><strong>Total &pound;0</strong></td>

                                </tr>
                            </tfoot>
                        </table>
                    </td>
                </tr>
                <tr>
                    <th class="bg-secondary text-white">Billing Details</th>
                </tr>
                <tr>
                    <td>
                        <div class="row">
                            <div class="col-md-3">
                                <input class="form-control" placeholder="First Name" required id="b-first-name" name="b_first_name" type="text">
                            </div>
                            <div class="col-3">
                                <input class="form-control" placeholder="Last Name" required id="b-last-name" name="b_last_name" type="text">
                            </div>
                            <div class="col-3">
                                <input class="form-control" required placeholder="Email" id="b-email" name="b_email" type="email">
                            </div>
                            <div class="col-2">
                                <div class="ui-widget">
                                <input class="form-control" placeholder="Check Postcode" id="b-postcode-lookup" name="b_postcode_lookup" type="text">
                                </div>
                            </div>
                            <div class="col-1">
                                <p class="mt-2 text-donate message"><span class="spinner-border spinner-border-sm d-none" role="status" aria-hidden="true"></span></p>
                            </div>
                            <p class="mt-2 mb-0 col-3 text-red d-none message">Test</p>
                        </div>
                        <div class="row mt-2 d-none" id="address-details">
                            <div class="col-3">
                                <input class="form-control" placeholder="Address" required id="b-address1" name="b_address1" type="text">
                            </div>
                            <div class="col-3">
                                <input class="form-control" placeholder="Address" id="b-address2" name="b_address2" type="text">
                            </div>
                            <div class="col-3">
                                <input class="form-control" placeholder="City/Town" required id="b-town" name="b_city" type="text">
                            </div>
                            <div class="col-3">
                                <input class="form-control" placeholder="County" id="b-county" name="b_county" type="text">
                            </div>
                            <div class="col-3">
                                <div class="mt-2" id="address-switch">
                                    Delivery address same as billing?
                                    <label class="switch">
                                        <input id="address-switch" name="address-switch" type="checkbox" value="1">
                                        <span class="slider round"></span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </td>
                </tr>
                <tr>
                    <th class="bg-secondary text-white">Delivery Details</th>
                </tr>
                <tr>
                    <td>
                        <div class="row">
                            <div class="col-md-4">
                                <div class="form-group">
                                    <input class="form-control" placeholder="First Name" required id="d-first-name" name="d_first_name" type="text">
                                </div>
                            </div>
                            <div class="col-4">
                                <div class="form-group">
                                    <input class="form-control" placeholder="Last Name" required id="d-last-name" name="d_last_name" type="text">
                                </div>
                            </div>
                            <div class="col-4">
                                <div class="form-group">
                                    <input class="form-control" required placeholder="Email" id="d-email" name="d_email" type="email">
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-3">
                                <input class="form-control" placeholder="Address" required id="d-address1" name="d_address1" type="text">
                            </div>
                            <div class="col-3">
                                <input class="form-control" id="d-address2" name="d_address2" type="text">
                            </div>
                            <div class="col-2">
                                <input class="form-control" placeholder="City/Town" required id="d-town" name="d_town" type="text">
                            </div>
                            <div class="col-2">
                                <input class="form-control" placeholder="County" id="d-county" name="d_county" type="text">
                            </div>
                            <div class="col-2">
                                <div class="form-group">
                                    <input class="form-control" id="d-postcode" placeholder="Postcode" required name="d_postcode" type="text">
                                </div>
                            </div>
                        </div>
                    </td>
                </tr>
                <tr>
                    <th class="bg-secondary text-white">Payment</th>
                </tr>
                <tr>
                    <td>
                        <div class="row">
                            <div class="col-md-4">
                                <input id="payment-id" name="payment_method_id" type="hidden" value="">
                                <input id="total" name="total" type="hidden" value="0">

                                <input class="form-control" placeholder="Name on Card" id="card-holder-name" name="card-holder-name" type="text">
                            </div>
                            <div class="col-md-8">
                            <!-- Stripe Elements Placeholder -->
                                <div id="card-element"></div>
                            </div>
                            <div class="col-2 mt-2 offset-10">
                                <button id="card-button" class="float-right btn btn-primary">
                                    Process Payment
                                </button>
                            </div>

                        </div>
                    </td>
                </tr>

            </table>
            </form>
        </div>
    </div>
        <!-- Site footer
TODO Look at mobile version
-->
<footer class="footer text-white">
    <div class="d-none d-sm-flex">
        <div class="container">
            <div class="footer-top pb-2 mt-3 d-flex align-items-center position-relative">
                <div>
                    <!--<a href="/donate" class="btn py-1 px-5 text-uppercase pulse">Donate</a>-->
                </div>
                <div class="social d-flex ml-auto align-items-center">
                    <div class="icons d-none d-md-block">
                                                    <a target="_blank" href="https://www.facebook.com/karuna.org/"/> <i class="fab fa-facebook-f"></i> </a>
                                                    <a target="_blank" href="https://twitter.com/karuna_trust_uk?lang=en"/> <i class="fab fa-twitter"></i> </a>
                                                    <a target="_blank" href="https://www.instagram.com/karunatrust"/> <i class="fab fa-instagram"></i> </a>
                                                
                        
                        
                    </div>
                    <div>
                        <a class="btn rounded-10 py-1 px-5 ml-3 up-white-g" href="/contact">CONTACT</a>
                    </div>

                </div>

            </div>
            <img src="https://karuna.org/images/downloaded-assets/white-line.svg" class="w-100" alt="divider"/>
            <div class="icons d-md-none mt-3 float-right">
                <a href=""/><i class="fab fa-facebook-f"></i></a>
                <a href=""/><i class="fab fa-twitter"></i></a>
                <a href=""/><i class="fab fa-instagram"></i></a>
            </div>
            <div class="mb-3 mt-4 d-flex justify-content-between">
                <h4 class="d-none mb-0 d-md-block">Useful Links</h4>

            </div>

            <div class="footer-bottom d-md-flex">
                <div class="pr-5 d-none d-md-block">

                    <ul><li><a class="nav-link " href="/our-work" target="_self">Our Work</a></li><li><a class="nav-link " href="/projects" target="_self">Our Projects</a></li><li><a class="nav-link " href="/about-us" target="_self">About Us</a></li></ul>

                </div>
                <div class="pr-5 d-none d-md-block">

                    <ul><li><a class="nav-link " href="/fundraise" target="_self">Fundraise for Us</a></li><li><a class="nav-link " href="/legacies" target="_self">Leave a Gift in Your Will</a></li><li><a class="nav-link team" href="https://appeals.karuna.org/jobs" target="_self">Join the Team</a></li></ul>
                </div>
                <div class="pr-5 d-none d-md-block">

                    <ul><li><a class="nav-link " href="/trustees" target="_self">Trustees</a></li><li><a class="nav-link " href="/ambassadors" target="_self">Ambassadors</a></li><li><a class="nav-link " href="/financials" target="_self">Financials</a></li></ul>
                </div>

                <div class="pr-5 d-none d-md-block">
                    <ul><li><a class="nav-link " href="/faqs" target="_self">FAQs</a></li><li><a class="nav-link " href="/privacy-policy" target="_self">Privacy Policy</a></li><li><a class="nav-link " href="/safeguarding-policy" target="_self">Safeguarding Policy</a></li></ul>
                </div>

                <div class="footer-menu  text-right ml-auto">
                    The Karuna Trust<br/>
                    72 Holloway Road<br/>
                    London, N7 8JG
                </div>
            </div>
            <div class="d-md-flex align-items-center copywright mt-4">
                <p class="font-sm m-0">The Karuna Trust is a charity registered in England and Wales no. 327461 and a company limited by guarantee registered in England No. 2132178</p>
                <img src="https://karuna.org/images/fundraising-regulator-logo.png" class="ml-auto" alt="Fundraising Regulator"/>
            </div>
        </div>
    </div>
    <div class="d-flex d-md-none">
        <div class="container">
            <a href="/donate" class="btn py-1 px-5 text-uppercase d-block mx-auto w-75 pulse">Donate</a>
            <img src="https://karuna.org/images/downloaded-assets/white-line.svg" alt="divider" class="my-4"/>
            <a class="btn rounded-10 py-1 px-5 w-75 up-white-g d-block mx-auto" href="/contact">CONTACT</a>
            <div class="icons d-md-none mt-3 d-flex px-5 justify-content-between">
                <a href=""/><i class="fab fa-facebook-f"></i></a>
                <a href=""/><i class="fab fa-twitter"></i></a>
                <a href=""/><i class="fab fa-instagram"></i></a>
            </div>
            <div class="footer-menu my-4">
                The Karuna Trust<br/>
                72 Holloway Road<br/>
                London, N7 8JG
            </div>
            <p class="font-sm">The Karuna Trust is a charity registered in England and Wales no. 327461 and a company limited by guarantee registered in England No. 2132178</p>
            <img src="https://karuna.org/images/fundraising-regulator-logo.png" class="w-50 d-block mx-auto px-4 my-4" alt="Fundraising Regulator"/>
        </div>
    </div>

</footer>
</div>
<div class="modal fade" id="newsletterModal" tabindex="-1" role="dialog" aria-labelledby="newsletterModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="newsletterModalLabel">Keep In Touch</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <p>It is essential that Karuna can communicate with our supporters in order to ensure that the work we do is as effective as possible. Unlike other charities, we won’t bombard you. We will write to you twice a year with important updates on how your donation is making a difference and may call or email you from time to time to let you know about new events at Karuna. That’s it. You can change your preferences at any time by getting in touch. </p>
                <div class="well bg-beige p-2">
                    <form method="POST" action="https://www.karuna.org/newsletter" accept-charset="UTF-8" id="newsletter"><input name="_token" type="hidden" value="5MI5GyweWCbXl3aw6ejoWWgxDCs4rLdQTnd0oKvq">
                    <input id="email" name="email" type="hidden" value="">
                    <div class="form-row">
                        <div class="col-2">
                            <input class="title form-control" placeholder="Title" name="title" type="text">
                        </div>
                        <div class="col">
                            <input class="first_name form-control" placeholder="First Name" required name="first_name" type="text">
                        </div>
                        <div class="col">
                            <input class="last_name form-control" placeholder="Last Name" required name="last_name" type="text">
                        </div>
                        <div class="col">
                            <input class="email form-control" placeholder="Email" required name="email" type="email">
                        </div>
                    </div>
                    </form>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="submit" class="btn btn-primary newsletter-submit" form="newsletter">Submit</button>
            </div>
        </div>
    </div>
</div>
<script
    src="https://code.jquery.com/jquery-3.4.1.min.js"
    integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
    crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/wow/1.1.2/wow.min.js">    </script>
    <script>new WOW().init();</script>
<script src="https://karuna.org/js/app.js"></script>
    <script src="https://js.stripe.com/v3/"></script>
    <script
        src="https://code.jquery.com/ui/1.12.0/jquery-ui.min.js"
        integrity="sha256-eGE6blurk5sHj+rmkfsGYeKyZx3M4bG+ZlFyA7Kns7E="
        crossorigin="anonymous"></script>

    <script>
        $("#address-switch").on('change',function() {
            console.log($('#b-address1').val());

            $('#delivery-address').toggleClass('d-none');
            $('#d-address1').val($('#b-address1').val());
            $('#d-address2').val($('#b-address2').val());
            $('#d-town').val($('#b-town').val());
            $('#d-county').val($('#b-county').val());
            $('#d-postcode').val($('#b-postcode-lookup').val());
            $('#d-first-name').val($('#b-first-name').val());
            $('#d-last-name').val($('#b-last-name').val());
            $('#d-email').val($('#b-email').val());
        });

        //billing lookup
        var formElements = new Object();
        //add elements as jquery selectors
        formElements.postcodelookup = $("#b-postcode-lookup");
        formElements.postcode = $("#b-postcode");
        formElements.address1 = "#b-address1";
        formElements.address2 = "#b-address2";
        formElements.town = "#b-town";
        formElements.county = "#b-county";
        formElements.firstName = "#b-first-name";
        formElements.lastName = "#b-last-name";
        formElements.email = "#b-email";


        formElements.error_msg = "#error-msg";

        crafty_lookup(formElements);


        function crafty_lookup(elements){
            $(elements.postcodelookup).autocomplete({
                delay: 1000,
                source: function( request, response ) {
                    // if(enable_search){
                    $('.spinner-border').removeClass('d-none');
                    $.ajax({
                        url: "https://pcls1.craftyclicks.co.uk/json/rapidaddress",
                        dataType: "jsonp",
                        data: {
                            postcode: $(elements.postcodelookup).val(),
                            response: 'data_formatted',
                            lines: '2',
                            sort: 'asc',
                            key: "0848a-35599-12954-0253f"
                        },
                        success: function(data) {
                            $('.spinner-border').addClass('d-none');
                            if(data.error_code != undefined){
                                //handle error message
                                alert(data.error_msg);
                                $('#address-details').removeClass('d-none')
                                $('.message').removeClass('d-none').text('Please enter your address manually below')
                            }
                            else{
                                $('.spinner-border').addClass('d-none');
                                var clear_data = new Array();
                                $.each( data.delivery_points, function( index, item ) {
                                    var fullLabel = item.department_name;
                                    if(fullLabel != '' && item.line_1 != '')
                                        fullLabel = fullLabel + ', ' + item.line_1;
                                    else
                                        fullLabel = fullLabel + item.line_1;

                                    if(fullLabel != '' && item.line_2 != '')
                                        fullLabel = fullLabel + ', ' + item.line_2;
                                    else
                                        fullLabel = fullLabel + item.line_2;

                                    clear_data.push({
                                        town: data.town,
                                        postcode: data.postcode,
                                        county: data.postal_county,

                                        line_1: item.line_1,
                                        line_2: item.line_2,

                                        udprn: item.udprn,
                                        label: fullLabel,
                                        value: data.postcode
                                    });
                                });
                                response( clear_data );
                            }
                        }
                    });
                    //     enable_search = 0;
                    // }
                },
                minLength: 0,
                select: function( event, ui ) {
                    $('#address-details').removeClass('d-none')
                    $(elements.town).val(ui.item.town);
                    if(ui.item.line_1!='' && ui.item.line_2 != '')
                        $(elements.address1).val(leading_caps(ui.item.line_1 +', '+ ui.item.line_2));
                    else
                        $(elements.address1).val(leading_caps(ui.item.line_1 ));
                    $(elements.address2).val(leading_caps(ui.item.line_2) );

                    $(elements.postcode).val(ui.item.postcode);


                    // do any action on selecting a result
                },
                open: function() {
                    // do any action on showing the results
                },
                close: function() {
                    $(elements.postcodelookup).autocomplete({ disabled: true });
                    $(elements.postcodelookup).blur();

                    // do any action on closing the results
                }
            });
            $(elements.postcode).autocomplete({ disabled: true });

            $(elements.button).on('click', function(){
                enable_search = 1;
                $(elements.postcode).autocomplete({ disabled: false });
                $(elements.postcode).autocomplete("search", "");
            });

            $(elements.postcode).on('keydown',function(){
                $(elements.postcode).autocomplete({ disabled: true });
                $('.ui-autocomplete').css('display','none');
            });
        }
        function leading_caps(a){if(2>a.length)return a;for(var b="",c=a.split(" "),d=0;d<c.length;d++){var e=this.str_trim(c[d]);""!=e&&(""!=b&&(b+=" "),b+=this.cp_uc(e))}return b}function str_trim(a){for(var b=0,c=a.length-1;b<a.length&&" "==a[b];)b++;for(;c>b&&" "==a[c];)c-=1;return a.substring(b,c+1)}function cp_uc(a){if("PC"==a||"UK"==a||"EU"==a)return a;for(var b="ABCDEFGHIJKLMNOPQRSTUVWXYZ",c="",d=1,e=0,f=0;f<a.length;f++)-1!=b.indexOf(a.charAt(f))?d||e?(c+=a.charAt(f),d=0):c+=a.charAt(f).toLowerCase():(c+=a.charAt(f),f+2>=a.length&&"'"==a.charAt(f)?d=0:"("==a.charAt(f)?(close_idx=a.indexOf(")",f+1),close_idx>f+3?(e=0,d=1):e=1):")"==a.charAt(f)?(e=0,d=1):"-"==a.charAt(f)?(close_idx=a.indexOf("-",f+1),-1!=close_idx&&f+3>=close_idx||f+3>=a.length?(e=0,d=0):(e=0,d=1)):d=f+2<a.length&&"0"<=a.charAt(f)&&"9">=a.charAt(f)?0:1);return c}

        //stripe code
        const stripe = Stripe('pk_live_4LDNCdgtbnAdfRF7YC7K579f');

        const elements = stripe.elements();
        const cardElement = elements.create('card');

        cardElement.mount('#card-element');

        const cardHolderName = document.getElementById('card-holder-name');
        const cardButton = document.getElementById('card-button');

        cardButton.addEventListener('click', async (e) => {

            const { paymentMethod, error } = await stripe.createPaymentMethod(
                'card', cardElement, {
                    billing_details: { name: cardHolderName.value }
                }
            );

            if (error) {
                console.log(error)
                alert(error)
            } else {

                $.ajax({
                    url: "https://www.karuna.org/shop/process-checkout",
                    type:"POST",
                    data:{'_token':$('input[name ="_token"]').val(),'stripe_id': paymentMethod.id, 'b_first_name': $('input[name ="b_first_name"]').val(),
                        'b_last_name': $('input[name ="b_last_name"]').val(), 'b_email':$('input[name ="b_email"]').val(),
                        'b_postcode_lookup':$('input[name ="b_postcode_lookup"]').val(),'b_address1':$('input[name ="b_address1"]').val(),
                        'b_address2':$('input[name ="b_address2"]').val(),'b_city':$('input[name ="b_city"]').val(),
                        'b_county':$('input[name ="b_county"]').val(),'d_first_name': $('input[name ="d_first_name"]').val(),
                        'd_last_name': $('input[name ="d_last_name"]').val(), 'd_email':$('input[name ="d_email"]').val(),
                        'd_postcode_lookup':$('input[name ="d_postcode_lookup"]').val(),'d_address1':$('input[name ="d_address1"]').val(),
                        'd_address2':$('input[name ="d_address2"]').val(),'d_town':$('input[name ="d_town"]').val(),
                        'd_county':$('input[name ="d_county"]').val(), 'd_postcode':$('input[name ="d_postcode"]').val(),
                        'card-holder-name': $('input[name ="card_name"]').val(),
                        'card_brand':paymentMethod.card.brand, 'card_last_four': paymentMethod.card.last4,
                         'total':$('input[name ="total"]').val()},
                    success:function(response){
                        $('.alert').removeClass('d-none')
                        $('.alert p').html('Thank you for your order.It will be shipped to you shortly')
                        $('.count').html(0);
                        $(window).scrollTop(0);
                    },
                });
            }
        });
    </script>
    </body>
</html>
